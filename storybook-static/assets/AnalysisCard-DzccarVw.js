import{a as n,t as g,c as R,b as G,n as W}from"./template-CIKGjA4E.js";import{p as Me,l as Le,a as Ae,t as _,b as Ve,s as K,g as m,d as E,m as Q,c as l,e as c,f as T,h as Be}from"./runtime-CsLX-Eqq.js";import{i as p,s as x}from"./if-BJwBTplU.js";import{h as He}from"./html-ynStkv79.js";import{i as $e,e as M,s as De,a as Ie}from"./store-CEga9lFI.js";import{s as k,t as f}from"./class-BhzPnwhT.js";import{s as V}from"./event-modifiers-Bd-89TeU.js";import{p as U}from"./props-ucnq1n3h.js";import{c as Se,o as je}from"./index-client-C32oe8zx.js";import{p as Ee}from"./fileInfo-DmhC3Ja7.js";var Ue=W('<svg class="-ml-0.5 mr-1.5 h-2 w-2 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Pe=W('<svg class="-ml-0.5 mr-1.5 h-3 w-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Fe=g('<div class="font-medium text-purple-700"> </div>'),Ne=g("<div> </div>"),qe=g('<div class="text-gray-700"> </div>'),Je=g('<div class="mt-3 rounded border border-gray-100 bg-gray-50 p-2 text-sm"><!></div>'),Oe=g('<button class="inline-flex items-center rounded bg-orange-100 px-2.5 py-1.5 text-xs font-medium text-orange-700 transition-colors hover:bg-orange-200" title="Cancel this analysis"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1 h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> Cancel</button>'),Re=g('<button class="inline-flex items-center rounded bg-green-100 px-2.5 py-1.5 text-xs font-medium text-green-700 transition-colors hover:bg-green-200"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1 h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg> Export</button>'),Ge=g('<button class="inline-flex items-center rounded bg-red-100 px-2.5 py-1.5 text-xs font-medium text-red-700 transition-colors hover:bg-red-200" title="Delete this analysis"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1 h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414L9.586 12l-2.293 2.293a1 1 0 101.414 1.414L11 13.414l2.293 2.293a1 1 0 001.414-1.414L12.414 12l2.293-2.293z" clip-rule="evenodd"></path></svg> Delete</button>'),Ke=g('<div class="actions mt-3 flex justify-end gap-2"><button class="inline-flex items-center rounded bg-blue-100 px-2.5 py-1.5 text-xs font-medium text-blue-700 transition-colors hover:bg-blue-200"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1 h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path></svg> View</button> <!> <!> <!></div>'),Qe=g('<div><div class="flex items-start"><div><!></div> <div class="flex-grow"><div class="flex items-start justify-between"><h3> </h3> <div><!> <span class="capitalize"> </span></div></div> <div><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1 h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd"></path></svg> <span class="truncate"> </span></div> <div class="mt-0.5 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="mr-1 h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path></svg> <span class="text-gray-600"><!></span></div></div> <!></div></div> <!></div>');function Te(X,L){Me(L,!1);const[Y,Z]=De(),B=()=>Ie(Ee,"$persistentFileStore",Y);let e=U(L,"analysis",24,()=>({})),y=U(L,"compact",8,!1),ee=U(L,"selected",8,!1),H=Q(null),w=Q(null),P=!1;const z=Se();function F(t){if(!t)return"Unknown";const s=new Date(t),h=new Date-s,v=Math.floor(h/6e4),r=Math.floor(v/60),u=Math.floor(r/24);return v<1?"just now":v<60?`${v} min ago`:r<24?`${r} hr ago`:u<7?`${u} days ago`:s.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function te(t){switch(t){case"fel":return`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-14a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V4z" clip-rule="evenodd" />
        </svg>`;case"meme":return`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
        </svg>`;case"slac":return`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
        </svg>`;case"busted":return`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />
        </svg>`;case"datareader":return`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" />
        </svg>`;default:return`<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd" />
        </svg>`}}async function se(){if(!e()||!e().result||e().method==="datareader")return null;try{P=!0;const t=typeof e().result=="string"?JSON.parse(e().result):e().result;if(!t)return null;if(["fel","slac","meme","fubar"].includes(e().method)){if(t.tested&&t.tested.sites)return{text:`${t.tested.sites.filter(a=>a.p<=.05&&(a.beta>a.alpha||a.posterior>=.9)).length} positive sites found`,type:"selection"}}else if(e().method==="busted"&&t.test_results&&t.test_results.p){const s=t.test_results.p,a=s<=.05;return{text:a?`Positive selection detected (p=${s.toExponential(2)})`:`No selection detected (p=${s.toExponential(2)})`,type:"hypothesis",significant:a}}return{text:`${e().method.toUpperCase()} results`,type:"generic"}}catch(t){return console.error("Error generating result preview:",t),null}finally{P=!1}}je(async()=>{K(w,await se())});function ae(){z("select",{analysisId:e().id})}function le(){z("view",{analysisId:e().id})}function re(){z("export",{analysisId:e().id})}function ie(){z("cancel",{analysisId:e().id})}function ne(){z("delete",{analysisId:e().id})}Le(()=>(Be(e()),B()),()=>{e()&&e().fileId&&B().files&&K(H,B().files.find(t=>t.id===e().fileId))}),Ae(),$e();var A=Qe(),N=l(A),$=l(N),oe=l($);He(oe,()=>te(e().method));var de=c($,2),q=l(de),D=l(q),ve=l(D),d=c(D,2),J=l(d);{var ce=t=>{var s=Ue();n(t,s)},ue=t=>{var s=R(),a=T(s);{var h=v=>{var r=Pe();n(v,r)};p(a,v=>{e().status==="completed"&&v(h)},!0)}n(t,s)};p(J,t=>{e().status==="running"||e().status==="pending"?t(ce):t(ue,!1)})}var pe=c(J,2),fe=l(pe),I=c(q,2),O=l(I),me=c(l(O),2),ge=l(me),we=c(O,2),he=c(l(we),2),xe=l(he);{var ye=t=>{var s=G();_(a=>x(s,`Completed ${a??""}`),[()=>F(e().completedAt||e().createdAt)],E),n(t,s)},be=t=>{var s=G();_(a=>x(s,`Created ${a??""}`),[()=>F(e().createdAt)],E),n(t,s)};p(xe,t=>{e().status==="completed"?t(ye):t(be,!1)})}var _e=c(I,2);{var ke=t=>{var s=Je(),a=l(s);{var h=r=>{var u=Fe(),C=l(u);_(()=>x(C,m(w).text)),n(r,u)},v=r=>{var u=R(),C=T(u);{var S=i=>{var b=Ne(),j=l(b);_(()=>{k(b,`${(m(w).significant?"text-green-700":"text-orange-700")??""} font-medium`),x(j,m(w).text)}),n(i,b)},o=i=>{var b=qe(),j=l(b);_(()=>x(j,m(w).text)),n(i,b)};p(C,i=>{m(w).type==="hypothesis"?i(S):i(o,!1)},!0)}n(r,u)};p(a,r=>{m(w).type==="selection"?r(h):r(v,!1)})}n(t,s)};p(_e,t=>{!y()&&m(w)&&t(ke)})}var ze=c(N,2);{var Ce=t=>{var s=Ke(),a=l(s),h=c(a,2);{var v=o=>{var i=Oe();M("click",i,V(ie)),n(o,i)};p(h,o=>{["pending","running","mounting","processing","saving"].includes(e().status)&&o(v)})}var r=c(h,2);{var u=o=>{var i=Re();M("click",i,V(re)),n(o,i)};p(r,o=>{e().status==="completed"&&o(u)})}var C=c(r,2);{var S=o=>{var i=Ge();M("click",i,V(ne)),n(o,i)};p(C,o=>{["completed","error","cancelled"].includes(e().status)&&o(S)})}M("click",a,V(le)),n(t,s)};p(ze,t=>{y()||t(Ce)})}_((t,s)=>{k(A,`analysis-card mb-3 rounded-lg border transition-all duration-200 ${(y()?"p-3":"p-4")??""} ${(ee()?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm")??""}`),k($,`mr-3 ${(y()?"h-8 w-8":"h-10 w-10")??""} flex flex-shrink-0 items-center justify-center rounded-md bg-blue-100 text-blue-600`),k(D,`font-medium ${(y()?"text-sm":"text-base")??""}`),x(ve,`${t??""} Analysis`),k(d,`${(y()?"text-xs":"text-sm")??""} inline-flex items-center rounded-full px-2 py-0.5`),f(d,"bg-green-100",e().status==="completed"),f(d,"text-green-800",e().status==="completed"),f(d,"bg-yellow-100",e().status==="running"||e().status==="pending"),f(d,"text-yellow-800",e().status==="running"||e().status==="pending"),f(d,"bg-red-100",e().status==="error"),f(d,"text-red-800",e().status==="error"),f(d,"bg-orange-100",e().status==="cancelled"),f(d,"text-orange-800",e().status==="cancelled"),f(d,"bg-gray-100",s),f(d,"text-gray-800",s),x(fe,e().status==="completed"?"Completed":e().status==="cancelled"?"Cancelled":e().status||"unknown"),k(I,`text-gray-500 ${(y()?"mt-0.5 text-xs":"mt-1 text-sm")??""}`),x(ge,m(H)?m(H).filename:"Unknown file")},[()=>e().method?e().method.toUpperCase():"Unknown",()=>!["completed","running","pending","error","cancelled"].includes(e().status)],E),M("click",A,ae),n(X,A),Ve(),Z()}Te.__docgen={version:3,name:"AnalysisCard.svelte",data:[{name:"analysis",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{}"},static:!1,readonly:!1,defaultValue:"{}"},{name:"compact",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"selected",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"}],computed:[],methods:[],components:[],description:null,keywords:[],events:[{visibility:"public",description:null,keywords:[],name:"select"},{visibility:"public",description:null,keywords:[],name:"view"},{visibility:"public",description:null,keywords:[],name:"export"},{visibility:"public",description:null,keywords:[],name:"cancel"},{visibility:"public",description:null,keywords:[],name:"delete"}],slots:[],refs:[]};export{Te as A};
