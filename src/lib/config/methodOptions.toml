[fel]
description = "FEL (Fixed Effects Likelihood) estimates site-wise synonymous (α) and non-synonymous (β) rates, and uses a likelihood ratio test to determine if beta ≠ alpha at a site."

[[fel.options]]
name = "code"
description = "Which genetic code should be used"
takes_value = true
type = "string"
default = "Universal"
choices = [
    { value = "Universal", description = "Universal code" },
    { value = "Vertebrate mtDNA", description = "Vertebrate mitochondrial DNA code" },
    { value = "Yeast mtDNA", description = "Yeast mitochondrial DNA code" },
    { value = "Mold/Protozoan mtDNA", description = "Mold, Protozoan and Coelenterate mt; Mycoplasma/Spiroplasma" },
    { value = "Invertebrate mtDNA", description = "Invertebrate mitochondrial DNA code" },
    { value = "Ciliate Nuclear", description = "Ciliate, Dasycladacean and Hexamita Nuclear code" },
    { value = "Echinoderm mtDNA", description = "Echinoderm mitochondrial DNA code" },
    { value = "Euplotid Nuclear", description = "Euplotid Nuclear code" },
    { value = "Alt. Yeast Nuclear", description = "Alternative Yeast Nuclear code" },
    { value = "Ascidian mtDNA", description = "Ascidian mitochondrial DNA code" },
    { value = "Flatworm mtDNA", description = "Flatworm mitochondrial DNA code" },
    { value = "Blepharisma Nuclear", description = "Blepharisma Nuclear code" },
]

[[fel.options]]
name = "alignment"
description = "An in-frame codon alignment in one of the formats supported by HyPhy"
takes_value = true
type = "file"
choices = []

[[fel.options]]
name = "tree"
description = "A phylogenetic tree (optionally annotated with {})"
takes_value = true
type = "tree"
default = ""
choices = []

[[fel.options]]
name = "branches"
description = "Branches to test"
takes_value = true
type = "branch-set"
default = "All"
choices = []

[[fel.options]]
name = "srv"
description = "Include synonymous rate variation in the model"
takes_value = true
type = "string"
default = "Yes"
choices = [
    { value = "Yes", description = "[Recommended] Consider synonymous rate variation (dS varies across sites)." },
    { value = "No", description = "Ignore synonymous rate variation (dS := 1 at each site)." },
]

[[fel.options]]
name = "multiple-hits"
description = "Include support for multiple nucleotide substitutions"
takes_value = true
type = "string"
default = "None"
choices = [
    { value = "Double", description = "Include branch-specific rates for double nucleotide substitutions" },
    { value = "Double+Triple", description = "Include branch-specific rates for double and triple nucleotide substitutions" },
    { value = "None", description = "[Default] Use standard models which permit only single nucleotide changes to occur instantly" },
]

[[fel.options]]
name = "pvalue"
description = "The p-value threshold to use when testing for selection"
takes_value = true
type = "number"
default = 0.1
choices = []

[[fel.options]]
name = "ci"
description = "Compute profile likelihood confidence intervals for each variable site"
takes_value = true
type = "string"
default = "No"
choices = [
    { value = "Yes", description = "Compute profile likelihood confidence intervals for dN/dS at each site (~2x slower)." },
    { value = "No", description = "[Default] Do not compute likelihood confidence intervals" },
]

[[fel.options]]
name = "resample"
description = "[Advanced setting, will result in MUCH SLOWER run time] Perform parametric bootstrap resampling to derive site-level null LRT distributions up to this many replicates per site. Recommended use for small to medium (<30 sequences) datasets"
takes_value = true
type = "number"
default = 0
minimum = 0
maximum = 1000

[[fel.options]]
name = "site-multihit"
description = "Estimate multiple hit rates for each site"
takes_value = true
type = "string"
default = "Estimate"
choices = [
    { value = "Estimate", description = "Include branch-specific rates for double nucleotide substitutions" },
    { value = "Global", description = "Use a plug-in estimate derived from the global model fit" },
]

[[fel.options]]
name = "precision"
description = "Optimization precision settings for preliminary fits"
takes_value = true
type = "string"
default = "standard"
choices = [
    { value = "standard", description = "[Default] Use standard optimization settings." },
    { value = "reduced", description = "Cruder optimizations settings for faster fitting of preliminary models" },
]

[[fel.options]]
name = "full-model"
description = "Perform branch length re-optimization under the full codon model"
takes_value = true
type = "string"
default = "Yes"
choices = [
    { value = "Yes", description = "[Default] Perform branch length re-optimization under the full codon model" },
    { value = "No", description = "Skip branch length re-optimization under the full codon model (faster but less precise)" },
]

[slac]
description = "SLAC (Single-Likelihood Ancestor Counting) uses a combination of maximum-likelihood and counting approaches to infer nonsynonymous (dN) and synonymous (dS) substitution rates on a per-site basis."

[[slac.options]]
name = "code"
description = "Which genetic code should be used"
takes_value = true
type = "string"
default = "Universal"
choices = [
    { value = "Universal", description = "Universal code" },
    { value = "Vertebrate mtDNA", description = "Vertebrate mitochondrial DNA code" },
    { value = "Yeast mtDNA", description = "Yeast mitochondrial DNA code" },
    { value = "Mold/Protozoan mtDNA", description = "Mold, Protozoan and Coelenterate mt; Mycoplasma/Spiroplasma" },
    { value = "Invertebrate mtDNA", description = "Invertebrate mitochondrial DNA code" },
    { value = "Ciliate Nuclear", description = "Ciliate, Dasycladacean and Hexamita Nuclear code" },
    { value = "Echinoderm mtDNA", description = "Echinoderm mitochondrial DNA code" },
    { value = "Euplotid Nuclear", description = "Euplotid Nuclear code" },
    { value = "Alt. Yeast Nuclear", description = "Alternative Yeast Nuclear code" },
    { value = "Ascidian mtDNA", description = "Ascidian mitochondrial DNA code" },
    { value = "Flatworm mtDNA", description = "Flatworm mitochondrial DNA code" },
    { value = "Blepharisma Nuclear", description = "Blepharisma Nuclear code" },
]

[[slac.options]]
name = "alignment"
description = "An in-frame codon alignment in one of the formats supported by HyPhy"
takes_value = true
type = "file"
choices = []

[[slac.options]]
name = "tree"
description = "A phylogenetic tree (optionally annotated with {})"
takes_value = true
type = "tree"
default = ""
choices = []

[[slac.options]]
name = "branches"
description = "Branches to test"
takes_value = true
type = "branch-set"
default = "All"
choices = []

[[slac.options]]
name = "samples"
description = "number of samples to assess ancestral reconstruction uncertainty"
takes_value = true
type = "number"
default = 100
choices = []

[[slac.options]]
name = "pvalue"
description = "The p-value threshold to use when testing for selection"
takes_value = true
type = "number"
default = 0.1
choices = []

[meme]
description = "MEME (Mixed Effects Model of Evolution) tests for episodic positive selection at individual sites, allowing the selective pressure to vary across branches."

[[meme.options]]
name = "code"
description = "Which genetic code should be used"
takes_value = true
type = "string"
default = "Universal"
choices = []

[[meme.options]]
name = "alignment"
description = "An in-frame codon alignment in one of the formats supported by HyPhy"
takes_value = false
type = "string"
choices = []

[[meme.options]]
name = "tree"
description = "A phylogenetic tree (optionally annotated with {})"
takes_value = false
applies_to = "Please select a tree file for the data:"
type = "string"
choices = []

[[meme.options]]
name = "branches"
description = "Branches to test"
takes_value = true
type = "string"
default = "All"
choices = []

[[meme.options]]
name = "pvalue"
description = "The p-value threshold to use when testing for selection"
takes_value = true
type = "string"
default = "0.1"
choices = []

[[meme.options]]
name = "resample"
description = "[Advanced setting, will result in MUCH SLOWER run time] Perform parametric bootstrap resampling to derive site-level null LRT distributions up to this many replicates per site. Recommended use for small to medium (<30 sequences) datasets"
takes_value = true
type = "number"
default = "50"
choices = []

[[meme.options]]
name = "rates"
description = "The number omega rate classes to include in the model [2-4]"
takes_value = true
type = "number"
default = "2"
choices = []

[[meme.options]]
name = "multiple-hits"
description = "Include support for multiple nucleotide substitutions"
takes_value = true
type = "string"
default = "None"
choices = [
    { value = "Double", description = "Include branch-specific rates for double nucleotide substitutions" },
    { value = "Double+Triple", description = "Include branch-specific rates for double and triple nucleotide substitutions" },
    { value = "None", description = "[Default] Use standard models which permit only single nucleotide changes to occur instantly" },
]

[[meme.options]]
name = "site-multihit"
description = "Estimate multiple hit rates for each site"
takes_value = true
type = "string"
default = "Estimate"
choices = [
    { value = "Estimate", description = "Include branch-specific rates for double nucleotide substitutions" },
    { value = "Global", description = "Use a plug-in estimate derived from the global model fit" },
]

[[meme.options]]
name = "impute-states"
description = "Use site-level model fits to impute likely character states for each sequence"
takes_value = true
type = "string"
default = "No"
choices = [
    { value = "Yes", description = "Impute marginal likelihoods for each codon at each sequence and each site" },
    { value = "No", description = "Do not impute marginal likelihoods for each codon at each sequence and each site" },
]

[[meme.options]]
name = "precision"
description = "Optimization precision settings for preliminary fits"
takes_value = true
type = "string"
default = "standard"
choices = [
    { value = "standard", description = "[Default] Use standard optimization settings" },
    { value = "reduced", description = "Cruder optimizations settings for faster fitting of preliminary models" },
]

[[meme.options]]
name = "full-model"
description = "Perform branch length re-optimization under the full codon model"
takes_value = true
type = "string"
default = "Yes"
choices = [
    { value = "Yes", description = "[Default] Perform branch length re-optimization under the full codon model" },
    { value = "No", description = "Skip branch length re-optimization under the full codon model (faster but less precise)" },
]

[contrast-fel]
description = "Contrast-FEL (Contrast Fixed Effects Likelihood) is a method used to assess whether selective pressures differ between two or more sets of branches at a particular site in a phylogenetic tree."

[[contrast-fel.options]]
name = "code"
description = "Which genetic code should be used"
takes_value = true
type = "string"
default = "Universal"
choices = [
    { value = "Universal", description = "Universal code" },
    { value = "Vertebrate mtDNA", description = "Vertebrate mitochondrial DNA code" },
    { value = "Yeast mtDNA", description = "Yeast mitochondrial DNA code" },
    { value = "Mold/Protozoan mtDNA", description = "Mold, Protozoan and Coelenterate mt; Mycoplasma/Spiroplasma" },
    { value = "Invertebrate mtDNA", description = "Invertebrate mitochondrial DNA code" },
    { value = "Ciliate Nuclear", description = "Ciliate, Dasycladacean and Hexamita Nuclear code" },
    { value = "Echinoderm mtDNA", description = "Echinoderm mitochondrial DNA code" },
    { value = "Euplotid Nuclear", description = "Euplotid Nuclear code" },
    { value = "Alt. Yeast Nuclear", description = "Alternative Yeast Nuclear code" },
    { value = "Ascidian mtDNA", description = "Ascidian mitochondrial DNA code" },
    { value = "Flatworm mtDNA", description = "Flatworm mitochondrial DNA code" },
    { value = "Blepharisma Nuclear", description = "Blepharisma Nuclear code" },
]

[[contrast-fel.options]]
name = "alignment"
description = "An in-frame codon alignment in one of the formats supported by HyPhy"
takes_value = true
type = "file"
choices = []

[[contrast-fel.options]]
name = "tree"
description = "A phylogenetic tree (optionally annotated with {})"
takes_value = true
type = "tree"
default = ""
choices = []

[[contrast-fel.options]]
name = "branch-set"
description = "Specify which branches to compare (e.g., Source and Test groups)"
takes_value = true
type = "branch-set"
default = ""
choices = []

[[contrast-fel.options]]
name = "srv"
description = "Include synonymous rate variation in the model"
takes_value = true
type = "string"
default = "Yes"
choices = [
    { value = "Yes", description = "[Recommended] Consider synonymous rate variation (dS varies across sites)." },
    { value = "No", description = "Ignore synonymous rate variation (dS := 1 at each site)." },
]

[[contrast-fel.options]]
name = "permutations"
description = "Specify whether to perform permutation tests"
takes_value = true
type = "string"
default = "Yes"
choices = [
    { value = "Yes", description = "[Default] Perform permutation significance tests" },
    { value = "No", description = "Skip permutation significance tests" },
]

[[contrast-fel.options]]
name = "pvalue"
description = "The significance value for site tests"
takes_value = true
type = "number"
default = 0.05
choices = []

[[contrast-fel.options]]
name = "qvalue"
description = "The significance value for False Discovery Rate reporting"
takes_value = true
type = "number"
default = 0.20
choices = []

[[contrast-fel.options]]
name = "output"
description = "Specify an output file for the results"
takes_value = true
type = "string"
default = ""
choices = []

[gard]
description = "GARD (Genetic Algorithm for Recombination Detection) screens a multiple sequence alignment for recombination. It is useful as a pre-processing step for selection inference since recombinant sequences cannot be adequately described with a single phylogenetic history."

[[gard.options]]
name = "code"
description = "Which genetic code should be used"
takes_value = true
type = "string"
default = "Universal"
choices = [
    { value = "Universal", description = "Universal code" },
    { value = "Vertebrate mtDNA", description = "Vertebrate mitochondrial DNA code" },
    { value = "Yeast mtDNA", description = "Yeast mitochondrial DNA code" },
    { value = "Mold/Protozoan mtDNA", description = "Mold, Protozoan and Coelenterate mt; Mycoplasma/Spiroplasma" },
    { value = "Invertebrate mtDNA", description = "Invertebrate mitochondrial DNA code" },
    { value = "Ciliate Nuclear", description = "Ciliate, Dasycladacean and Hexamita Nuclear code" },
    { value = "Echinoderm mtDNA", description = "Echinoderm mitochondrial DNA code" },
    { value = "Euplotid Nuclear", description = "Euplotid Nuclear code" },
    { value = "Alt. Yeast Nuclear", description = "Alternative Yeast Nuclear code" },
    { value = "Ascidian mtDNA", description = "Ascidian mitochondrial DNA code" },
    { value = "Flatworm mtDNA", description = "Flatworm mitochondrial DNA code" },
    { value = "Blepharisma Nuclear", description = "Blepharisma Nuclear code" },
]

[[gard.options]]
name = "alignment"
description = "Sequence alignment to screen for recombination"
takes_value = true
type = "file"
choices = []

[[gard.options]]
name = "type"
description = "The type of data to perform screening on"
takes_value = true
type = "string"
default = "codon"
choices = [
    { value = "codon", description = "Codon-based analysis" },
    { value = "nucleotide", description = "Nucleotide-based analysis" },
    { value = "protein", description = "Protein-based analysis" },
]

[[gard.options]]
name = "model"
description = "The substitution model to use"
takes_value = true
type = "string"
default = "JTT"
choices = [
    { value = "JTT", description = "Jones-Taylor-Thornton model" },
    { value = "WAG", description = "Whelan and Goldman model" },
    { value = "LG", description = "Le and Gascuel model" },
    { value = "Dayhoff", description = "Dayhoff model" },
    { value = "GTR", description = "General Time Reversible model" },
    { value = "HKY85", description = "Hasegawa-Kishino-Yano model" },
    { value = "TN93", description = "Tamura-Nei model" },
    { value = "JC69", description = "Jukes-Cantor model" },
]

[[gard.options]]
name = "mode"
description = "Run mode"
takes_value = true
type = "string"
default = "Normal"
choices = [
    { value = "Normal", description = "Thorough analysis (recommended)" },
    { value = "Faster", description = "Faster but less comprehensive analysis" },
]

[[gard.options]]
name = "rv"
description = "Site-to-site rate variation"
takes_value = true
type = "string"
default = "None"
choices = [
    { value = "None", description = "No rate variation" },
    { value = "GDD", description = "General Discrete Distribution" },
    { value = "Gamma", description = "Beta-Gamma distribution" },
]

[[gard.options]]
name = "rate-classes"
description = "Number of site rate classes to use"
takes_value = true
type = "number"
default = 4
minimum = 2
maximum = 10

[[gard.options]]
name = "output"
description = "Write the resulting JSON to this file"
takes_value = true
type = "string"
default = ""
choices = []
